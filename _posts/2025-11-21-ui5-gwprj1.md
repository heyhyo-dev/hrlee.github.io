---
title: "[UI5] Gateway Service로 항공사 리포트 구현하기"
excerpt: "SAP Gateway Project1"

categories:
  - UI5
tags:
  - [UI5]

permalink: /ui5/gwprj1/

toc: true
toc_sticky: true

date: 2025-11-21
last_modified_at: 2025-11-21
---

<img width="1536" height="1024" alt="image" src="https://github.com/user-attachments/assets/4c4339a3-ae0a-49ea-8046-dd754b9f00e9" />


> **메인 프로세스 전개 과정**   
> 1. Gateway Service를 생성한다.
> 2. Data Model 생성 후 MPC(Model Provider Class)의 메소드를 재정의한다.
> 3. BAS에서 view 로직 추가하여 실행한다.


---

## Gateway Service 생성하기 <mark>SEGW</mark>
<img width="928" height="536" alt="image" src="https://github.com/user-attachments/assets/8d294033-5c8b-4c09-a6bd-12a875572689" />  

<img width="562" height="227" alt="image" src="https://github.com/user-attachments/assets/613f58f9-a7f0-4f57-88d1-6268eaf02881" />  

+ Data Model   
  - Entity Type : 테이블의 구조(스키마)에 해당하는 오브젝트로, 필드(속성, Property)들의 집합이다.  
  <img width="1754" height="195" alt="image" src="https://github.com/user-attachments/assets/7fac5b64-72ca-4f56-9cf4-27791f32d06d" />

  - Associations : 두 Entity Type 간의 관계(Relationship). DB에서 FK(외래키) 관계와 유사한 개념이다.
    
  - Entity Set : Entity Type 의 컬렉션(Collection). 하나의 Entity Type 은 하나의 Entity Set 에 매핑된다. 입력/조회/수정/삭제/검색 기능이 적용된다.  
  <img width="1256" height="190" alt="image" src="https://github.com/user-attachments/assets/bdca6d89-686a-485c-a2e6-be83cfbf91f6" />  

---

### Entity Type 생성
SAP SFLIGHT Table 기반으로 생성해보자.  
<img width="977" height="414" alt="image" src="https://github.com/user-attachments/assets/8ef28337-c12e-4bcf-9535-8d0abf6516a5" />  

<img width="1229" height="669" alt="image" src="https://github.com/user-attachments/assets/e1205863-1cce-48fb-893c-a9dc18bcb250" />  
MANDT 제외한 필드 선택, Serach Help도 선택 가능하다.  

<img width="1229" height="673" alt="image" src="https://github.com/user-attachments/assets/43a30429-67d3-46a2-9338-6cdf623292cd" />
키 필드를 체크하여 설정한다.  

<img width="1276" height="471" alt="image" src="https://github.com/user-attachments/assets/0465830f-69a8-407a-ab35-cace1a2b707a" />  
**Entity Type, Entity Set, Service Implementation 이 생성된다.**  

<img width="1810" height="462" alt="image" src="https://github.com/user-attachments/assets/75f667f6-6027-4e03-a69a-2d5b7ced558c" />  
* Scale : decimal type의 소수점 아래 자릿수  
* Unit Property Name : 금액처럼 통화가 필요한 경우 Reference할 Property를 지정함. (SFLIGHT에서 이미 지정되어 있어서 따로 지정하지 않는다.)  

<img width="1860" height="336" alt="image" src="https://github.com/user-attachments/assets/8ddcc09f-0893-4c4a-bac8-5c6151f10579" />  
Entity Sets의 SflightEntitySet 더블클릭하여 entityset에 생성/갱신/삭제 체크박스 표시한다.  

generate 버튼 클릭하여 활성화한다.  

> 그러나 바로 사용할 수 없다. CRUD 로직을 넣어야 사용 가능하다.

---

## OData 서비스 생성/활성화하기
<img width="1020" height="447" alt="image" src="https://github.com/user-attachments/assets/3bd71d64-ed5b-4941-97b9-6b9d70db31fe" />  
<img width="715" height="163" alt="image" src="https://github.com/user-attachments/assets/1a9fb830-c997-4bd9-ada8-55bd8ff49ece" />  
/n/IWFND/MAINT_SERVICE 와 같은 행위다.  


## Data Model 생성 - Data Provider Class
<mark>SEGW</mark>  
<img width="663" height="377" alt="image" src="https://github.com/user-attachments/assets/558028af-12ac-4cbc-a890-cd059733b496" />  
이제 CRUD-Q 로직을 구현하기 위해 더블클릭하여 Class로 이동한다.  

<img width="969" height="350" alt="image" src="https://github.com/user-attachments/assets/342f5f63-b881-4434-97d7-ddd214533e90" />  
*재정의된 건 검은색으로 표시된다.*  
SflightEntitySet처럼 Free Style Modeling으로 만들어진 Entity Set의 경우에는 Method 안에 Exception 처리 로직만 있다.  
따라서, Data Provider Extension Class에서 관련 Method를 Redefine한 후 직접 데이터 컨트롤 로직을 구현해야 한다.  

<details>
<summary>`SFLIGHTENTITYSET_CREATE_ENTITY` 1개의 Entry를 전달받아 신규 데이터를 생성하는 Method. </summary>
<div markdown="1">
```abap
  METHOD SFLIGHTENTITYSET_CREATE_ENTITY.
    DATA : LS_REQUEST_INPUT_DATA TYPE YCL_YGWSFLIGHT2_MPC_EXT=>TS_SFLIGHTENTITY.
    DATA : LS_DATA TYPE SFLIGHT.

    "전달받은 입력 대상 데이터 추출
    IO_DATA_PROVIDER->READ_ENTRY_DATA( IMPORTING ES_DATA = LS_REQUEST_INPUT_DATA ).

    "저장 데이터 구조로 변환
    LS_DATA = CORRESPONDING #( LS_REQUEST_INPUT_DATA ).

    "데이터 저장
    INSERT SFLIGHT FROM LS_DATA.

    "저장 성공 데이터 반환
    ER_ENTITY = CORRESPONDING #( LS_DATA ).

  ENDMETHOD.
```  
</div>
</details>

* `SFLIGHTENTITYSET_CREATE_ENTITY` 1개의 Entry를 전달받아 신규 데이터를 생성하는 Method.  
* `SFLIGHTENTITYSET_DELETE_ENTITY` Key Property에 따라 1개 Entity를 삭제하는 Method.  
* `SFLIGHTENTITYSET_GET_ENTITY` Key Property에 따라 1개의 Entry만 반환하는 Method.  
* `SFLIGHTENTITYSET_GET_ENTITYSET` Filter값에 따른 1개 이상의 Entry들을 반환하는 Method.  
* `SFLIGHTENTITYSET_UPDATE_ENTITY` 1개의 Entry를 전달받아 Key값 기반으로 기존 데이터를 수정하는 Method.  








계속 추가해야 해...












## 코드 
<img width="462" height="178" alt="image" src="https://github.com/user-attachments/assets/7dc076c1-e58c-494f-a93d-bcfca819d1f1" />
1. SE11에서 조회될 ViewName  
2. Annotation(@)을 확장하여 OData 서비스를 통해 CDS View를 생성할 수 있다.  
3. SFLIGHT 테이블에서 데이터 가져올 것  
4. 전체 데이터  

활성화 시, Annotation 때문에 시스템이 자동 OData 서비스를 생성  
→ OData 서비스 이름: YDESD_SFLIGHT99_CDS  

---

## 서비스 추가 및 활성화 `/N/IWFND/MAINT_SERVICE`
*앞으로 작명한 이름 뒤에 99가 아니라 70으로 스크린샷이 보일 텐데 같은 것이라고 생각하기 (캡처 이슈)* 
<img width="1735" height="432" alt="image" src="https://github.com/user-attachments/assets/da666ef2-5b16-4664-98ef-1d1ed3e650d0" />  
기술 서비스 이름 란에 OData 서비스 이름(YDESD_SFLIGHT99_CDS)을 기입 후 엔터  
해당 서비스 선택 > ‘선택한 서비스 추가’ 클릭  

<img width="1292" height="862" alt="image" src="https://github.com/user-attachments/assets/e18097d5-b0e6-40b5-97b6-4aec9259be0f" />  
프로젝트용이니까 로컬로 만든다.  

<img width="1113" height="807" alt="image" src="https://github.com/user-attachments/assets/e407db85-4068-4ffd-a9d5-6f13c5a13068" />  
간혹 안 되면, 위 활성화를 클릭한다.  

---

## uri Path 확인 `SICF`
<img width="1300" height="631" alt="image" src="https://github.com/user-attachments/assets/cf750515-67e9-4ff9-a70f-5fda06abec51" />  
OData 서비스 이름(YDESD_SFLIGHT99_CDS)을 입력하여 실행한다. 

<img width="1270" height="522" alt="image" src="https://github.com/user-attachments/assets/6b829828-beb4-4a37-8244-32f478978d44" />  
uri path를 확인할 수 있다. 서비스가 활성화된 것도 확인 가능하다.  
이 Path를 아래 서비스 테스트에서 입력한다.

---

## 서비스 테스트 `/N/IWFND/GW_CLIENT`
<img width="1788" height="506" alt="image" src="https://github.com/user-attachments/assets/a7307da9-9faf-4339-a850-ff3ad0bddbc8" />  
위에서 확인한 Path를 입력하여 실행한다.  
 xml:base= "http://주소/sap/opu/odata/sap/YDESD_SFLIGHT70_CDS/"> 를 메모장에 복사해둔다. ( 이후 BAS에서 필요 )  
<img width="1869" height="861" alt="image" src="https://github.com/user-attachments/assets/22e2321e-0dcc-47eb-948c-9320e3941e01" />   
상단 오른쪽의 Add URI Option 버튼을 클릭하여 $metadata 를 선택한다. > Execute 한다.    
→ 속성의 이름, 타입, 길이, 필드 라벨 등 확인 가능하다.   
<img width="1853" height="819" alt="image" src="https://github.com/user-attachments/assets/0b45b143-a960-4b70-9b1a-3b6598dfe559" />
Entity Set 버튼을 클릭하면 SFLIGHT 테이블의 실제 데이터를 확인할 수 있다.  

---

## BAS에서 Report 생성하여 실행
BAS를 실행하여 F1 > Fiori: Open Application Generator 로 새 프로젝트를 열어준다.  
Template Selection : Basic  

<img width="1299" height="460" alt="image" src="https://github.com/user-attachments/assets/660ec3ef-3af7-4729-b8f9-b1eae071491d" />  

Entity Selection ] View Name : List  

Project Attributes ] 이름, 타이틀은 원하는 대로 변경하여 finish.



### List.view 로직 추가
path는 entityset(예:/YDESD_SFLIGHT99)으로 입력한다. 

```xml

```  

### i18n 로직 추가
<img width="731" height="400" alt="image" src="https://github.com/user-attachments/assets/66c2caa6-6418-41ca-95fd-79fb1a37b74d" />  


### 결과
*terminal - 해당 프로젝트 경로에서(cd project1) npm install / npm run start*  
<img width="1902" height="861" alt="image" src="https://github.com/user-attachments/assets/c0294d96-6972-4fa7-bce4-1142a8475293" />  

>SAP 서버의 SFLIGHT 데이터를 UI5로 구현한 화면이 조회된다.
